Terraform, EC2 Container Service (ECS) and Docker
=================================================

This example demos how Terraform provision AWS instances, based on *"Infrastructure As Code"* principle.

Under this directory, after you run *"terraform apply"* on these Terraform configuration, a new AWS ECS will be created.

Have Terraform installed. Create a file *"terraform.tfvars"* which including AWS access and secret keys (terraform.tfvars.sample file):

[source.console]
----
access_key = "This is AWS account's Access Key"
secret_key = "This is AWS account's Secret Key"
----

==== Verify provision plan 
[source.console]
----
12:29:09 𝜆 terraform plan -var 'key_name=aws-key' -var 'key_path=/Users/terrence/.ssh/aws-key.pem'
...
----

==== Run 
Create AWS instance, install ECS agent and start Docker container:

[source.console]
----
12:29:09 𝜆 terraform apply -var 'key_name=aws-key' -var 'key_path=/Users/terrence/.ssh/aws-key.pem'
...
----

==== Destroy all resource

[source.console]
----
11:42:29 𝜆 terraform destroy -var 'key_name=aws-key' -var 'key_path=/Users/terrence/.ssh/aws-key.pem'
...
----

==== Check Docker application status

[source.console]
----
09:13:57 𝜆 ecs-cli ps
Name                                                        State    Ports                         TaskDefinition
7e4d36f1-b016-487a-9dfc-f808c995a3f6/hello-world-container  RUNNING  54.206.39.253:5000->5000/tcp  hello-world-task:5
----


References
----------
- Terraform AWS ECS + Docker Registry, https://github.com/Capgemini/terraform-amazon-ecs
- Setup local / private Docker Registry, http://slides.com/victororlov/docker-registry-presentation, https://github.com/fforloff/docker-registry-presentation
- Test Docker images with Python, https://docs.google.com/presentation/d/1EzA8Zpq0GdTvbPzs0Ou6gXZZlJGfug0vsoEbxeyERsg/edit?usp=sharing


Copying
-------
Copyright © 2016 - Terrence Miao. Free use of this software is granted under the terms of the GNU General Public License version 3 (GPLv3).
